<!DOCTYPE html>
<head>
    <meta charset = "utf-8">
    
    <title>My Parse App</title>
    <meta name = "description" content = "My Parse App">
    <meta name = "viewport" content = "width=device-width">
    
    <script src = "https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.3.1.min.js"></script>
    
    <script type = "text/javascript" src = "https://npmcdn.com/parse/dist/parse.min.js"></script>
    
</head>

<body>
    <div id = "login">
       <p> id : <input type = "text" id = "id"> </p>
       <p> pw : <input type = "text" id = "password"> </p>
       <p> email : <input type = "text" id = "email"> </p>
       <input type = "button" value = "SIGNUP" onclick = "signup()">
        <input type = "button", value = "LOGIN" onclick="login()">
    </div>
    <script type = "text/javascript">
        Parse.initialize("seungmin");
        Parse.serverURL = "http://immense-bastion-72940.herokuapp.com/parse"
        
        function login() {
            var id = $("#id").val();
            var password = $("#password").val();
            
            Parse.User.logIn(id, password)
            .then((user) => {
                alert("Login Success : Welcome! " + user.get("username"));
                window.location = "gamesnake.html";
            }, (error) => {
                alert("login error : " + error.message);
                $("#password").val("");
            });
        }
        
        function signup(){
            var id = $("#id").val();
            var password = $("#password").val();
            var email = $("#email").val();
            var user = new Parse.User();
            
            if(Parse.User.current()){
                Parse.User.logOut();
            }
            
            if(id && password && email){
                user.set("username", id);
                user.set("password", password);
                user.set("email", email);
                
                user.signUp()
                .then((user)=> {
                    alert("SignUp Success");
                    window.location = "signin.html"
                }, (error) => {
                    alert("SignUp Error : " + error.message);
                });
            }
            else {
                alert("wrong data");
            }
        }
    </script>
</body>
</html>
